{"version":3,"sources":["webpack:///src/app/workspace/workspace.component.html","webpack:///src/app/workspace/workspace.component.ts","webpack:///src/app/workspace/shared/job.service.ts","webpack:///src/app/workspace/shared/history-loading/history-loading.component.ts","webpack:///src/app/workspace/shared/history-loading/history-loading.component.html","webpack:///src/app/workspace/shared/display-values/display-values.component.html","webpack:///src/app/workspace/shared/display-values/display-values.component.ts","webpack:///src/app/workspace/shared/export-modal/export-modal.component.html","webpack:///src/app/workspace/shared/export-modal/export-modal.component.ts","webpack:///src/app/workspace/shared/set-cutoff/set-cutoff.component.html","webpack:///src/app/workspace/shared/set-cutoff/set-cutoff.component.ts","webpack:///src/app/workspace/shared/set-highlight/set-highlight.component.ts","webpack:///src/app/workspace/shared/set-highlight/set-highlight.component.html","webpack:///src/app/workspace/shared/result-viewer/result-viewer.component.html","webpack:///src/app/workspace/shared/result-viewer/result-viewer.component.ts","webpack:///src/app/workspace/history/history.component.html","webpack:///src/app/workspace/history/history.component.ts","webpack:///src/app/workspace/workspace-routing.module.ts","webpack:///src/app/workspace/workspace.module.ts"],"names":["WorkspaceComponent","JobService","HistoryLoadingComponent","router","historySrvc","notify","navSrvc","histories","isLoading","this","routeReuseStrategy","shouldReuseRoute","getUserHistory","getAll","pipe","finalize","subscribe","data","map","h","deserialize","updateBadge","confirm","deleteAll","success","msg","id","delete","clearHistory","http","url","endpoints","api","of","uuid","status","result","alias","scores","start","raw_score","DisplayValuesComponent","fileSrvc","headers","values","objectKeys","Object","keys","exportAsExcelFile","name","exportToExcel","ExportModalComponent","list","to","isChecked","push","filter","f","items","length","_items","SetCutoffComponent","SetHighlightComponent","option","operators","desc","op","builder","onSet","highlightForm","group","from","compose","min","required","max","value","emit","get","set","ResultViewerComponent","sqSrvc","modal","route","loader","featureSrvc","_data","isSearching","options","filters","operatorsFn","a","b","i","construct","dna_seq","pos","score","Math","random","nav","nativeElement","document","querySelectorAll","forEach","x","setAttribute","dnaSeq","proteinSeq","toProteinSeqVw","protein_seq","tracksElem","getTrackView","tracks","color","saver","preSave","startLoading","base","querySelector","title","createElement","innerHTML","insertBefore","firstChild","element","style","display","fontSize","postSave","removeChild","getElementById","stopLoading","destroyModal","track","accession","end","val","split","join","floor","fixedHighlight","getByAlias","cutoffs","getElementsByTagName","visibility","c","tplModal","create","nzTitle","nzContent","nzWidth","nzComponentParams","nzOnOk","cmp","Number","isNaN","setThreshold","type","afterClose","d","operator","find","o","v","clearCutoffs","info","valuesModal","nzWrapClassName","nzFooter","getRandomColor","s","norm_score","motif","motifInSeq","count","positions","charAt","substring","error","err","features","e","ft","description","genome_min","genome_max","exportToGb","key","nzOkText","l","destroy","Array","isArray","export","snapshot","history","saveFileAs","mimetype","filename","console","log","r","generateScores","getFeatures","exportModal","searchMotif","displayAll","hideAll","changeColors","clearHighlight","HistoryComponent","WorkspaceRoutingModule","jobSrvc","titleSrvc","isJobLoading","trackHovered","attempts","setTitle","getJob","interval","clearInterval","getById","job_id","job","isDone","resultData","isActive","setInterval","nzCancelText","navigate","str","txt","path","component","workspace","detail","resolve","forChild","WorkspaceModule"],"mappings":"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E,iBACF,OACF,OACF,OAEA,kBAEE,kBACE,iBACE,kBACE,iBACF,OACF,OACF,OAEA,kBACE,iBACE,kBACE,iBACF,OACF,OACF,OAEA,kBACE,iBACE,kBACE,iBACF,OACF,OACF,OAEA,kBACE,iBACE,kBACE,iBACF,OACF,OACF,OAEF,OAEF,OAEF,OAEA,kBAEE,iBACE,iBACE,iBACF,OACF,OAEA,iBACE,kBACE,iBACA,iBACA,iBACA,iBACA,iBACF,OACF,OAEF,OAEA,kBAEE,iBACE,iBACE,iBACF,OACF,OAEA,iBACE,kBACE,iBACF,OAEA,oBAEE,iBACE,cACE,cACE,kBACE,iBACF,OACF,OACA,cACE,kBACE,iBACF,OACF,OACF,OACA,cACE,cACE,iBACE,iBACF,OACF,OACA,cACE,iBACE,iBACF,OACF,OACF,OACF,OAEF,OACF,OAEF,OAEA,kBAEE,iBACE,iBACE,kBACF,OACF,OAEA,kBAEE,mBACE,mBACF,OAEF,OAEF,OAEF,OAEF,OAEF,OAEF,OAEA,mBAEE,kBACE,kBACE,mBACE,kBACA,kBACA,kBACA,kBACA,kBACF,OACA,mBACE,kBACA,kBACA,kBACA,kBACA,kBACF,OACA,mBACE,kBACA,kBACA,kBACA,kBACA,kBACF,OACA,mBACE,kBACA,kBACA,kBACA,kBACA,kBACF,OACA,mBACE,kBACA,kBACA,kBACA,kBACA,kBACF,OACA,mBACE,kBACA,kBACA,kBACA,kBACA,kBACF,OACF,OACF,OAEF,OAEF,OA1RF,S,sDC+BY,aACE,QACF,Q,uBADE,yB,yBAQF,aACE,QACF,Q,0CADE,4B,yBAFJ,aACE,sBAGF,Q,gCAHM,yCC7BT,IAAMuC,EAAN,IAAMA,EAAN,WAUL,WACUC,EACArC,2BADA,KAAAqC,WACA,KAAArC,SAVD,KAAAsC,QAAoB,GACpB,KAAAC,OAAgB,GAKzB,KAAAC,WAAaC,OAAOC,KARf,6DAgBCtC,KAAKmC,SACPnC,KAAKiC,SAASM,kBAAkB,CAAC,CAAEC,KAAM,SAAUhC,KAAMR,KAAKmC,UAC9DnC,KAAKJ,OAAOmB,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","file":"x","sourcesContent":["<div class=\"ui main container\">\n\n  <div class=\"ui padded grid p-4\">\n\n    <div class=\"sixteen wide column\">\n      <h1 class=\"ui header\">Recent history</h1>\n    </div>\n\n    <div class=\"row\">\n\n      <div class=\"eleven wide column\">\n        <p>\n          Here you can find the history of all the <strong>jobs</strong> submitted.\n        </p>\n        <p>\n          <i class=\"info circle icon\"></i> Note that such history is <strong>session</strong> based, this means that it'll expire after a certain time or if browser data is cleared.\n        </p>\n      </div>\n\n      <div class=\"five wide column right aligned\">\n\n        <button type=\"button\" class=\"ui red right labeled icon button\" (click)=\"clearHistory()\" [disabled]=\"!isLoading && !histories.length\" name=\"button\">\n          Clear history <i class=\"trash icon\"></i>\n        </button>\n\n      </div>\n\n    </div>\n\n    <div class=\"one column row\">\n\n      <div class=\"column center aligned p-8\" *ngIf=\"!isLoading && !histories.length\">\n        <div class=\"ui icon header meta\">\n          <i class=\"inbox icon\"></i>\n          Yo have no history.\n        </div>\n      </div>\n\n      <div class=\"column\" *ngIf=\"!isLoading && histories.length\">\n\n        <div class=\"ui segment p-0\" [ngClass]=\"{'loading': isLoading}\">\n\n          <table class=\"ui very padded selectable basic table b-0\">\n\n            <thead>\n              <tr>\n                <th colspan=\"5\">\n                  Your history\n                </th>\n                <th class=\"right aligned\">\n                  {{histories.length}} entries\n                </th>\n              </tr>\n            </thead>\n\n            <tbody>\n\n              <tr [ngClass]=\"{'warning':  h.status != 'failed' && h.status != 'finished'}\" *ngFor=\"let h of histories\">\n                <td>\n                  <h3><a [routerLink]=\"[h.id]\">{{h.name}}</a></h3>\n                </td>\n                <td>\n                  <h3><a class=\"disabled\">{{h.construct.label}}</a></h3>\n                </td>\n                <td>\n                  {{h.construct?.specie?.name}}\n                </td>\n                <td>\n                  <time [dateTime]=\"h.created_at\">\n                    {{h.created_at | date: 'DD/MM/YYYY HH:mm'}}\n                  </time>\n                </td>\n                <td>\n                  <div class=\"ant-badge ant-badge-status ant-badge-not-a-wrapper link\" data-inverted=\"\" data-position=\"top center\" [attr.data-tooltip]=\"h.status | titlecase\">\n                    <span class=\"ant-badge-status-dot\" [ngClass]=\"{'ant-badge-status-error': h.status === 'failed',\n                      'ant-badge-status-success':  h.status === 'finished',\n                      'ant-badge-status-processing': h.status != 'failed' && h.status != 'finished'}\"></span>\n                  </div>\n                </td>\n                <td class=\"ui center aligned\">\n                  <a [sqy-clipboard]=\"h.id\" data-inverted=\"\" data-position=\"top center\" data-tooltip=\"Copy ID\">\n                    <i class=\"copy icon\"></i>\n                  </a>\n                  <a [routerLink]=\"['/editor', h.id]\" data-inverted=\"\" data-position=\"top center\" data-tooltip=\"Load on vector editor\">\n                    <i class=\"external link icon\"></i>\n                  </a>\n                  <a (click)=\"deleteHistory(h.id)\" data-inverted=\"\" data-position=\"top center\" data-tooltip=\"Delete\">\n                    <i class=\"trash link red icon\"></i>\n                  </a>\n                </td>\n              </tr>\n            </tbody>\n\n          </table>\n        </div>\n\n      </div>\n    </div>\n\n  </div>\n\n</div>\n","import { Component, OnInit } from '@angular/core';\nimport { Router } from '@angular/router';\nimport { finalize } from 'rxjs/operators';\n\nimport { NzMessageService } from 'ng-zorro-antd/message';\n\nimport { HistoryService } from './shared/history.service';\nimport { UserHistory } from './shared/user-history';\nimport { NavService } from '@services/nav.service';\n\n@Component({\n  selector: 'sqy-workspace',\n  templateUrl: './workspace.component.html',\n  styleUrls: ['./workspace.component.scss']\n})\nexport class WorkspaceComponent implements OnInit {\n\n  histories: UserHistory[] = [];\n  isLoading = false;\n\n  constructor(\n    private router: Router,\n    private historySrvc: HistoryService,\n    private notify: NzMessageService,\n    private navSrvc: NavService\n  ) {\n    this.router.routeReuseStrategy.shouldReuseRoute = () => false;\n  }\n\n  ngOnInit() {\n    this.isLoading = true;\n    this.getUserHistory();\n  }\n\n  getUserHistory() {\n    this.isLoading = true;\n    this.historySrvc.getAll()\n      .pipe(finalize(() => this.isLoading = false))\n      .subscribe(data => {\n        this.histories = data.map((h: any) => new UserHistory().deserialize(h)) || [];\n        this.navSrvc.updateBadge();\n      });\n  }\n\n  clearHistory() {\n    if (confirm('Are you sure that you want to clear history?. This action cannot be reverted.')) {\n      this.isLoading = true;\n      this.historySrvc.deleteAll()\n        .pipe(finalize(() => this.isLoading = false))\n        .subscribe(data => {\n          this.navSrvc.updateBadge();\n          this.getUserHistory();\n          this.notify.success(data.msg);\n        });\n    }\n  }\n\n  deleteHistory(id: string) {\n    if (confirm('Are you sure that you want to delete such history?. This action cannot be reverted.')) {\n      this.isLoading = true;\n      this.historySrvc.delete(id)\n        .pipe(finalize(() => this.isLoading = false))\n        .subscribe(() => {\n          this.navSrvc.updateBadge();\n          this.getUserHistory();\n          this.notify.success('History deleted!');\n        });\n    }\n  }\n\n}\n","import { Construct } from './../../shared/models/construct';\nimport { Injectable } from '@angular/core';\nimport { HttpClient } from '@angular/common/http';\nimport { Observable } from 'rxjs/internal/Observable';\n\nimport { environment as env } from '@env/environment';\nimport { Job } from './job';\nimport { of } from 'rxjs';\n\nconst URL_ENV = '/workspace/job/';\n\n@Injectable({ providedIn: 'root' })\nexport class JobService {\n\n  private url: string;  // URL to web api\n\n  constructor(private http: HttpClient) {\n    this.url = env.endpoints.api + URL_ENV;\n  }\n\n  getById(id: string): Observable<any> {\n    return of({\n      uuid: 'ecbc2279-0d4e-4844-83b4-e876ef089923',\n  status: 'finished',\n  result: [{\n    alias: 'A',\n    scores: [{start: 1, raw_score: 20},\n      {start: 20, raw_score: 0.80},\n      {start: 20, raw_score: 0.80},\n      {start: 20, raw_score: 0.80},\n      {start: 20, raw_score: 0.80},\n      {start: 20, raw_score: 0.80},\n      {start: 20, raw_score: 0.80},\n      {start: 20, raw_score: 0.80},\n    ]\n  }]\n    })\n    // return this.http.get<Job>(`${this.url}${id}`).pipe();\n  }\n\n}\n","import { Component } from '@angular/core';\n\n@Component({\n  selector: 'sqy-history-loading',\n  templateUrl: './history-loading.component.html',\n  styleUrls: ['./history-loading.component.scss']\n})\nexport class HistoryLoadingComponent {\n\n}\n","<div class=\"ui main fluid container p-4 mt-6\">\n\n  <div class=\"ui grid\">\n\n    <div class=\"row\">\n\n      <div class=\"ui container\">\n\n        <div class=\"sixteen wide column\">\n\n          <div class=\"ui padded one column grid\">\n\n            <div class=\"column\">\n              <div class=\"ui fluid placeholder\">\n                <div class=\"header\">\n                  <div class=\"line\"></div>\n                  <div class=\"line\"></div>\n                </div>\n              </div>\n            </div>\n\n            <div class=\"two column row\">\n\n              <div class=\"column\">\n\n              </div>\n\n              <div class=\"column txt-r\">\n\n                <a class=\"disabled\">\n                  <i class=\"trash icon\"></i>\n                  Delete history\n                </a>\n\n              </div>\n\n            </div>\n\n            <div class=\"column\">\n              <div class=\"ui fluid placeholder\">\n                <div class=\"paragraph\">\n                  <div class=\"line\"></div>\n                  <div class=\"line\"></div>\n                  <div class=\"line\"></div>\n                </div>\n              </div>\n            </div>\n\n            <div class=\"column\">\n              <div class=\"ui placeholder\">\n                <div class=\"paragraph\">\n                  <div class=\"line\"></div>\n                  <div class=\"line\"></div>\n                  <div class=\"line\"></div>\n                  <div class=\"line\"></div>\n                  <div class=\"line\"></div>\n                </div>\n              </div>\n            </div>\n\n          </div>\n\n        </div>\n\n      </div>\n\n    </div>\n\n    <div class=\"row\">\n\n      <div class=\"ui container\">\n\n        <div class=\"sixteen wide column\">\n\n          <div class=\"ui padded form grid\">\n\n            <div class=\"one column row\">\n              <div class=\"column txt-c\">\n                <div class=\"ui placeholder\">\n                  <div class=\"paragraph\">\n                    <div class=\"line\"></div>\n                  </div>\n                </div>\n              </div>\n            </div>\n\n            <div class=\"one column row\">\n\n              <div class=\"column\">\n\n                <div class=\"field\">\n                  <div class=\"ui fluid placeholder\">\n                    <div class=\"paragraph\">\n                      <div class=\"line\"></div>\n                    </div>\n                  </div>\n                </div>\n\n                <div class=\"four inline fields\">\n\n                  <div class=\"field\">\n                    <div class=\"ui fluid placeholder\">\n                      <div class=\"paragraph\">\n                        <div class=\"line\"></div>\n                      </div>\n                    </div>\n                  </div>\n\n                  <div class=\"field\">\n                    <div class=\"ui fluid placeholder\">\n                      <div class=\"paragraph\">\n                        <div class=\"line\"></div>\n                      </div>\n                    </div>\n                  </div>\n\n                  <div class=\"field\">\n                    <div class=\"ui fluid placeholder\">\n                      <div class=\"paragraph\">\n                        <div class=\"line\"></div>\n                      </div>\n                    </div>\n                  </div>\n\n                  <div class=\"field\">\n                    <div class=\"ui fluid placeholder\">\n                      <div class=\"paragraph\">\n                        <div class=\"line\"></div>\n                      </div>\n                    </div>\n                  </div>\n\n                </div>\n\n              </div>\n\n            </div>\n\n            <div class=\"one column row\">\n\n              <div class=\"column\">\n                <div class=\"ui fluid placeholder\">\n                  <div class=\"line\"></div>\n                </div>\n              </div>\n\n              <div class=\"column\">\n                <div class=\"ui placeholder\">\n                  <div class=\"line\"></div>\n                  <div class=\"line\"></div>\n                  <div class=\"line\"></div>\n                  <div class=\"line\"></div>\n                  <div class=\"line\"></div>\n                </div>\n              </div>\n\n            </div>\n\n            <div class=\"one column row\">\n\n              <div class=\"column\">\n                <div class=\"ui fluid placeholder\">\n                  <div class=\"line\"></div>\n                </div>\n              </div>\n\n              <div class=\"column\">\n                <div class=\"ui placeholder\">\n                  <div class=\"line\"></div>\n                </div>\n\n                <table class=\"ui blue padded sequence definition table\">\n\n                  <tbody>\n                    <tr>\n                      <th>\n                        <div class=\"ui placeholder\">\n                          <div class=\"line\"></div>\n                        </div>\n                      </th>\n                      <td>\n                        <div class=\"ui placeholder\">\n                          <div class=\"line\"></div>\n                        </div>\n                      </td>\n                    </tr>\n                    <tr>\n                      <th>\n                        <div class=\"ui fluid placeholder\">\n                          <div class=\"line\"></div>\n                        </div>\n                      </th>\n                      <td>\n                        <div class=\"ui fluid placeholder\">\n                          <div class=\"line\"></div>\n                        </div>\n                      </td>\n                    </tr>\n                  </tbody>\n\n                </table>\n              </div>\n\n            </div>\n\n            <div class=\"one column row\">\n\n              <div class=\"column\">\n                <div class=\"ui fluid placeholder\">\n                  <div class=\"line\"></div>\n                </div>\n              </div>\n\n              <div class=\"column\">\n\n                <div class=\"ui placeholder\">\n                  <div class=\"image\"></div>\n                </div>\n\n              </div>\n\n            </div>\n\n          </div>\n\n        </div>\n\n      </div>\n\n    </div>\n\n    <div class=\"one column row\">\n\n      <div class=\"column\">\n        <div class=\"ui fluid placeholder\">\n          <div class=\"paragraph\">\n            <div class=\"line\"></div>\n            <div class=\"line\"></div>\n            <div class=\"line\"></div>\n            <div class=\"line\"></div>\n            <div class=\"line\"></div>\n          </div>\n          <div class=\"paragraph\">\n            <div class=\"line\"></div>\n            <div class=\"line\"></div>\n            <div class=\"line\"></div>\n            <div class=\"line\"></div>\n            <div class=\"line\"></div>\n          </div>\n          <div class=\"paragraph\">\n            <div class=\"line\"></div>\n            <div class=\"line\"></div>\n            <div class=\"line\"></div>\n            <div class=\"line\"></div>\n            <div class=\"line\"></div>\n          </div>\n          <div class=\"paragraph\">\n            <div class=\"line\"></div>\n            <div class=\"line\"></div>\n            <div class=\"line\"></div>\n            <div class=\"line\"></div>\n            <div class=\"line\"></div>\n          </div>\n          <div class=\"paragraph\">\n            <div class=\"line\"></div>\n            <div class=\"line\"></div>\n            <div class=\"line\"></div>\n            <div class=\"line\"></div>\n            <div class=\"line\"></div>\n          </div>\n          <div class=\"paragraph\">\n            <div class=\"line\"></div>\n            <div class=\"line\"></div>\n            <div class=\"line\"></div>\n            <div class=\"line\"></div>\n            <div class=\"line\"></div>\n          </div>\n        </div>\n      </div>\n\n    </div>\n\n  </div>\n","<!-- Values viewer modal-->\n<div class=\"ui padded grid\">\n\n  <div class=\"row\" [hidden]=\"!title\">\n    <div class=\"column\">\n      <h2 class=\"ui header no-bold\">{{title}}</h2>\n    </div>\n  </div>\n\n  <div class=\"two column row\">\n\n    <div class=\"column\">\n      <strong> Total score:</strong> {{values?.length}}\n    </div>\n\n    <div class=\"column pr-5 right aligned\">\n      <button type=\"button\" name=\"download\" class=\"ui primary right labeled icon button\" (click)=\"exportToExcel()\">\n        Download as Excel\n        <i class=\"download icon\"></i>\n      </button>\n    </div>\n\n  </div>\n\n  <div class=\"row\">\n\n    <div class=\"column\">\n      <table class=\"ui selectable small compact table\">\n\n        <thead>\n          <tr>\n            <th *ngFor=\"let h of headers\">\n              {{h}}\n            </th>\n          </tr>\n        </thead>\n\n        <tbody>\n\n          <tr *ngFor=\"let value of values\">\n            <td *ngFor=\"let key of objectKeys(value)\">\n              {{value[key]}}\n            </td>\n          </tr>\n\n        </tbody>\n\n      </table>\n    </div>\n  </div>\n\n</div>\n","import { Component, Input } from '@angular/core';\n\nimport { NzMessageService } from 'ng-zorro-antd/message';\n\nimport { FileService } from '@services/file.service';\n\n@Component({\n  selector: 'sqy-display-values',\n  templateUrl: './display-values.component.html',\n  styleUrls: ['./display-values.component.scss']\n})\nexport class DisplayValuesComponent {\n\n  @Input() headers: string[] = [];\n  @Input() values: any[] = [];\n  @Input() min: number;\n  @Input() max: number;\n  @Input() title: string;\n\n  objectKeys = Object.keys;\n\n  constructor(\n    private fileSrvc: FileService,\n    private notify: NzMessageService\n  ) { }\n\n  exportToExcel() {\n    if (this.values) {\n      this.fileSrvc.exportAsExcelFile([{ name: 'Scores', data: this.values }]);\n      this.notify.success('Exported successfully!');\n    }\n  }\n\n}\n","<div class=\"ui padded grid\">\n\n  <div class=\"row\">\n    <div class=\"sixteen wide column\">\n      <h2 class=\"ui header no-bold\">Export as</h2>\n    </div>\n  </div>\n\n  <div class=\"row\">\n\n    <div class=\"four wide column\">\n      <label class=\"sqy label\">\n        <i class=\"file outline icon\"></i> GenBank\n      </label>\n      <input type=\"radio\" name=\"to\" value=\"gb\" [(ngModel)]=\"to\">\n    </div>\n\n    <div class=\"four wide column\">\n      <label class=\"sqy label\">\n        <i class=\"file excel outline icon\"></i> Excel\n      </label>\n      <input type=\"radio\" name=\"to\" value=\"excel\" [(ngModel)]=\"to\">\n    </div>\n\n  </div>\n\n  <div class=\"row\">\n    <div class=\"column\">\n      <h2 class=\"ui header no-bold\">Select items to export</h2>\n    </div>\n  </div>\n\n  <div class=\"one column row\">\n\n    <div class=\"column\">\n      <span class=\"meta\">If there is no item selected only scores will be exported.</span>\n    </div>\n\n    <div class=\"column pt-3\">\n      <span class=\"meta\">{{list.length}} / {{_items.length}} selected</span>\n    </div>\n\n    <div class=\"column\" *ngFor=\"let f of _items\">\n      <div class=\"ui checkbox\">\n        <input type=\"checkbox\" name=\"features\" checked (change)=\"featChange(f.alias, $event.target.checked)\">\n        <label>\n          <i class=\"circle icon\" [style.color]=\"f.color\"></i> {{f.name}}\n          <sqy-info-popup [content]=\"f.description\"></sqy-info-popup>\n        </label>\n      </div>\n\n    </div>\n\n  </div>\n\n</div>\n","import { Component, Input } from '@angular/core';\n\n@Component({\n  selector: 'sqy-export-modal',\n  templateUrl: './export-modal.component.html',\n  styleUrls: ['./export-modal.component.scss']\n})\nexport class ExportModalComponent {\n\n  list: any[] = [];\n  _items: any[];\n  to = 'gb';\n\n  @Input() set items(items: any[]) {\n    if (items.length > 0) {\n      this._items = items;\n      this.list = this._items.map(f => f.alias);\n    }\n  }\n\n  featChange(alias: string, isChecked: boolean) {\n    isChecked ? this.list.push(alias) : this.list = this.list.filter(f => f !== alias);\n  }\n\n}\n","<form class=\"ui tiny form\" *ngIf=\"option\">\n\n  <div class=\"two fields\">\n\n    <div class=\"field\">\n      <label>Option</label>\n      <nz-select name=\"operator\" nzSize=\"small\" nzPlaceHolder=\"Operator\" required [(ngModel)]=\"op\">\n        <nz-option *ngFor=\"let o of operators\" [nzLabel]=\"o.desc\" [nzValue]=\"o.op\"></nz-option>\n      </nz-select>\n    </div>\n\n    <div class=\"field\">\n      <label>Value</label>\n      <input type=\"number\" name=\"value\" placeholder=\"Enter a value\" required [(ngModel)]=\"value\"/>\n    </div>\n\n  </div>\n\n</form>\n","import { Component, Input } from '@angular/core';\n\n@Component({\n  selector: 'sqy-set-cutoff',\n  templateUrl: './set-cutoff.component.html',\n  styleUrls: ['./set-cutoff.component.scss']\n})\nexport class SetCutoffComponent {\n\n  @Input() option: any = null;\n\n  operators = [\n    { desc: 'Greater or equal than', op: '<=' },\n    { desc: 'Greater than', op: '<' },\n    { desc: 'Equal to', op: '=' },\n    { desc: 'Lower or equal than', op: '>=' },\n    { desc: 'Lower than', op: '>' }\n  ];\n  op = this.operators[0].op;\n  value: number;\n\n}\n","import { Component, OnInit, Input, Output, EventEmitter } from '@angular/core';\nimport { FormGroup, Validators, FormBuilder } from '@angular/forms';\n\n@Component({\n  selector: 'sqy-set-highlight',\n  templateUrl: './set-highlight.component.html',\n  styleUrls: ['./set-highlight.component.scss']\n})\nexport class SetHighlightComponent implements OnInit {\n\n  @Input() max: number;\n  @Output() onSet = new EventEmitter<string>();\n  highlightForm: FormGroup;\n\n  constructor(private builder: FormBuilder) { }\n\n  get from() {\n    return this.highlightForm.get('from');\n  }\n\n  get to() {\n    return this.highlightForm.get('to');\n  }\n\n  ngOnInit(): void {\n    this.highlightForm = this.builder.group({\n      from: [1, Validators.compose([\n        Validators.min(1),\n        Validators.required,\n        Validators.max(this.max - 1)\n      ])],\n      to: [this.max, Validators.compose([\n        Validators.required,\n        Validators.min(1),\n        Validators.max(this.max)\n      ])]\n    });\n  }\n\n  set() {\n    if (this.from.value <= this.to.value) {\n      this.onSet.emit(`${this.from.value}:${this.to.value}`);\n    }\n  }\n\n}\n","<form class=\"ui tiny form\" [formGroup]=\"highlightForm\" (ngSubmit)=\"set()\">\n\n  <div class=\"field\">\n    <span class=\"meta\">Enter positions to define highlight area.</span>\n  </div>\n\n  <div class=\"fields\">\n\n    <div class=\"field\" [ngClass]=\"{'error': from.invalid && (from.dirty || from.touched)}\">\n      <label>From</label>\n      <input type=\"number\" placeholder=\"From\" required name=\"highl-from\" formControlName=\"from\">\n    </div>\n\n    <div class=\"field\" [ngClass]=\"{'error': to.invalid && (to.dirty || to.touched)}\">\n      <label>To</label>\n      <input type=\"number\" placeholder=\"Max: {{max}}\" required name=\"highl-to\" formControlName=\"to\">\n    </div>\n\n  </div>\n\n  <div class=\"field\">\n    <button type=\"submit\" class=\"ui fluid primary button\" [disabled]=\"highlightForm.invalid\">Set</button>\n  </div>\n\n</form>\n","<div class=\"ui vertically divided grid\" style=\"margin-bottom: 4em\">\n\n  <div class=\"equal width center aligned middle aligned row\" style=\"padding: 0em\">\n\n    <div class=\"column\">\n      <a nz-dropdown nzTrigger=\"click\" [nzDropdownMenu]=\"hgMenu\" nzPlacement=\"bottomCenter\">\n        Highlight\n        <i class=\"dropdown icon\"></i>\n      </a>\n    </div>\n\n    <div class=\"column\">\n      <a (click)=\"exportModal()\">\n        <i class=\"download icon\"></i>\n        Export\n      </a>\n    </div>\n\n    <div class=\"column\">\n      <div class=\"ui icon fluid input\" [ngClass]=\"{'loading disabled': isSearching}\">\n        <i class=\"search icon\"></i>\n        <input type=\"text\" placeholder=\"Search for motif\" (keyup.enter)=\"searchMotif($event.target.value)\">\n      </div>\n    </div>\n\n    <div class=\"column\">\n      <p>\n        <i class=\"zoom icon\"></i> Use <strong>Ctrl</strong> + <strong>Scroll</strong> to zoom.\n      </p>\n    </div>\n\n    <div class=\"column\">\n      <protvista-saver element-id=\"results-graphs\" #saver file-name=\"sqrutiny_result\">\n        <button class=\"ui primary button\">\n          Download as PNG\n        </button>\n      </protvista-saver>\n    </div>\n\n  </div>\n\n  <div class=\"one column row\">\n\n    <div class=\"column mt-0\">\n\n      <protvista-manager attributes=\"length displaystart displayend highlight\">\n        <div class=\"ui very padded grid graphs\">\n\n          <div class=\"one column row\" id=\"results-graphs\">\n\n            <div class=\"column mb-3\">\n              <protvista-navigation #navigator class=\"protvista\"></protvista-navigation>\n              <protvista-sequence class=\"protvista\" highlight-event=\"onmouseover\" use-ctrl-to-zoom #dnaSeq></protvista-sequence>\n              <protvista-sequence class=\"protvista\" highlight-event=\"onmouseover\" use-ctrl-to-zoom #proteinSeq></protvista-sequence>\n              <protvista-interpro-track class=\"protvista\" shape=\"roundRectangle\" use-ctrl-to-zoom highlight-event=\"onmouseover\" #tracksView></protvista-interpro-track>\n            </div>\n\n            <div class=\"column no-sv\">\n              <p class=\"meta\">Click on each feature to show or hide</p>\n            </div>\n\n            <div class=\"column no-sv\">\n\n              <div class=\"ui top attached menu\">\n\n                <div class=\"item\">\n                  <a nz-dropdown nzTrigger=\"click\" [nzDropdownMenu]=\"graphsMenu\">\n                    <i class=\"cogs icon\"></i>\n                    Graphs\n                    <i class=\"dropdown icon\"></i>\n                  </a>\n                </div>\n\n                <a class=\"item\" *ngFor=\"let o of options\" [ngClass]=\"{'non-active': !o.display}\" (click)=\"o.display = !o.display\">\n                  <i class=\"circle icon\" [style.color]=\"o.color\"></i>\n                  <p class=\"feat-label\">{{o.name}}</p>\n                </a>\n\n              </div>\n\n            </div>\n\n            <div class=\"column pt-4\" [hidden]=\"!op.display\" *ngFor=\"let op of options; let i = index\">\n\n              <div class=\"ui padded grid\">\n\n                <div class=\"row\">\n                  <div class=\"column\">\n                    <h3 class=\"ui horizontal divider header\">{{op.name}}</h3>\n                  </div>\n                </div>\n\n                <div class=\"three column row mb-2 no-sv\">\n\n                  <div class=\"column s-action\">\n                    <a nz-dropdown nzTrigger=\"click\" [nzDropdownMenu]=\"acMenu\">\n                      Chart\n                      <i class=\"dropdown icon\"></i>\n                    </a>\n                    <a nz-dropdown nzTrigger=\"click\" [nzDropdownMenu]=\"dataMenu\">\n                      Data\n                      <i class=\"dropdown icon\"></i>\n                    </a>\n                    <a nz-dropdown nzTrigger=\"click\" [nzDropdownMenu]=\"sExMenu\">\n                      Export\n                      <i class=\"dropdown icon\"></i>\n                    </a>\n                    <a nz-dropdown nzTrigger=\"click\" [nzDropdownMenu]=\"cutMenu\">\n                      Cutoff\n                      <i class=\"dropdown icon\"></i>\n                    </a>\n\n                    <!-- Action -->\n                    <nz-dropdown-menu #acMenu=\"nzDropdownMenu\">\n                      <ul nz-menu nzSelectable>\n                        <li nz-menu-item (click)=\"changeColors(op.alias)\">\n                          <i class=\"sync icon\"></i>\n                          Change color\n                        </li>\n                        <li nz-menu-item (click)=\"op.display = false\">\n                          <i class=\"eye slash icon\"></i>\n                          Hide\n                        </li>\n                      </ul>\n                    </nz-dropdown-menu>\n\n                    <!-- Data -->\n                    <nz-dropdown-menu #dataMenu=\"nzDropdownMenu\">\n                      <ul nz-menu nzSelectable>\n                        <li nz-menu-item (click)=\"displayScore(op.alias)\">\n                          <i class=\"eye icon\"></i>\n                          Display all scores\n                        </li>\n                        <li nz-menu-item [nzDisabled]=\"!op.cutoffs\" (click)=\"displayCutoffs(op.alias)\">\n                          <i class=\"eye icon\"></i>\n                          Display cutoffs positions\n                        </li>\n                      </ul>\n                    </nz-dropdown-menu>\n\n                    <!-- Single Graph Export -->\n                    <nz-dropdown-menu #sExMenu=\"nzDropdownMenu\">\n                      <ul nz-menu nzSelectable>\n                        <li nz-menu-item (click)=\"exportToExcel(op.alias)\">\n                          <i class=\"file excel outline icon\"></i>\n                          Excel\n                        </li>\n                        <li nz-menu-item (click)=\"exportToGb({key: op.alias})\">\n                          <i class=\"dna icon\"></i>\n                          GenBank\n                        </li>\n                      </ul>\n                    </nz-dropdown-menu>\n\n                    <!-- Cutoff -->\n                    <nz-dropdown-menu #cutMenu=\"nzDropdownMenu\">\n                      <ul nz-menu nzSelectable>\n                        <li nz-menu-item (click)=\"cutoffModal(op.alias)\">\n                          Set cutoff\n                        </li>\n                        <!-- <li nz-menu-item>\n                          Set cutoff for minimum\n                        </li>\n                        <li nz-menu-item>\n                          Set cutoff for maximum\n                        </li> -->\n                        <li nz-menu-item [nzDisabled]=\"!op.cutoffs\" (click)=\"displayCutoffs(op.alias)\">\n                          <i class=\"eye icon\"></i>\n                          Display cutoffs positions\n                        </li>\n                        <li nz-submenu nzTitle=\"Download current threshold\" [nzDisabled]=\"!op.cutoffs\">\n                          <ul>\n                            <li nz-menu-item (click)=\"exportCutoffToGb(op.alias)\">\n                              <i class=\"dna icon\"></i> Download as GenBank\n                            </li>\n                            <li nz-menu-item (click)=\"exportCutoffToExcel(op.alias)\">\n                              <i class=\"file excel outline icon\"></i> Download as Excel\n                            </li>\n                          </ul>\n                        </li>\n                        <li nz-menu-item [nzDisabled]=\"!op.cutoffs\" (click)=\"clearCutoffs(op.alias)\">\n                          <i class=\"eraser icon\"></i> Clear cutoffs positions\n                        </li>\n                      </ul>\n                    </nz-dropdown-menu>\n\n                  </div>\n\n                  <div class=\"column txt-c cutoff\" id=\"cutoff_{{op.alias}}\" style=\"visibility: hidden\">\n                    <p></p>\n                  </div>\n\n                  <div class=\"column right aligned\">\n                    <div class=\"ui dropdown\" nz-dropdown nzTrigger=\"click\" [nzDropdownMenu]=\"vlMenu\">\n                      <div class=\"text\">\n                        <strong>Values: </strong>{{op.type === 'raw' ? 'Raw' : 'Normalized'}}\n                      </div>\n                      <i class=\"dropdown icon\"></i>\n                    </div>\n\n                    <!-- Values -->\n                    <nz-dropdown-menu #vlMenu=\"nzDropdownMenu\">\n                      <ul nz-menu nzSelectable>\n                        <li nz-menu-item (click)=\"switchScore(op.alias, 'raw')\">\n                          Raw <i [hidden]=\"op.type !== 'raw'\" class=\"check small icon\"></i>\n                        </li>\n                        <li nz-menu-item (click)=\"switchScore(op.alias, 'norm')\">\n                          Normalized <i [hidden]=\"op.type !== 'norm'\" class=\"check small icon\"></i>\n                        </li>\n                      </ul>\n                    </nz-dropdown-menu>\n\n                    <sqy-info-popup [content]=\"op.description\"></sqy-info-popup>\n\n                  </div>\n\n                </div>\n\n              </div>\n\n              <sqrutiny-matrix class=\"protvista score-graph\" id=\"{{op.alias}}\" height=\"70\" use-ctrl-to-zoom></sqrutiny-matrix>\n\n              <div class=\"ui two column grid no-sv\">\n\n                <div class=\"column\">\n                  <span class=\"meta\" style=\"font-size: .9em !important;\">\n                    Min: <strong>{{op.min}}</strong>\n                  </span>\n                </div>\n\n                <div class=\"column right aligned\">\n                  <span class=\"meta\" style=\"font-size: .9em !important;\">\n                    Max: <strong>{{op.max}}</strong>\n                  </span>\n                </div>\n\n              </div>\n            </div>\n          </div>\n\n        </div>\n      </protvista-manager>\n\n    </div>\n\n  </div>\n\n</div>\n\n<!-- Menus -->\n\n<!-- Visibility -->\n<nz-dropdown-menu #graphsMenu=\"nzDropdownMenu\">\n  <ul nz-menu nzSelectable>\n    <li nz-menu-item (click)=\"displayAll()\">\n      <i class=\"eye icon\"></i>\n      Display all\n    </li>\n    <li nz-menu-item (click)=\"hideAll()\">\n      <i class=\"eye icon\"></i>\n      Hide all\n    </li>\n    <li nz-menu-item (click)=\"changeColors()\">\n      <i class=\"sync icon\"></i>\n      Change colors\n    </li>\n  </ul>\n</nz-dropdown-menu>\n\n<!-- Highlight -->\n<nz-dropdown-menu #hgMenu=\"nzDropdownMenu\">\n  <ul nz-menu nzSelectable>\n    <li nz-menu-item nz-popover nzType=\"primary\" nzPopoverTrigger=\"click\" nzPopoverTitle=\"Set highlight by positions\" [nzPopoverContent]=\"hgTmplt\">\n      <i class=\"crosshairs icon\"></i>\n      Set highlight\n    </li>\n    <li nz-menu-item (click)=\"clearHighlight()\">\n      <i class=\"eraser icon\"></i>\n      Clear highlight\n    </li>\n  </ul>\n</nz-dropdown-menu>\n\n<!-- Popover templates -->\n<ng-template #hgTmplt>\n  <sqy-set-highlight [max]=\"_data.construct.dna_seq.length\" (onSet)=\"setHighlight($event)\"></sqy-set-highlight>\n</ng-template>\n","import { Component, Input, AfterViewInit, ViewChild, ElementRef, OnDestroy } from '@angular/core';\nimport { ActivatedRoute } from '@angular/router';\nimport { finalize } from 'rxjs/operators';\n\nimport { NzMessageService } from 'ng-zorro-antd/message';\nimport { NzModalService, NzModalRef } from 'ng-zorro-antd/modal';\nimport { ProtvistaSequence } from 'protvista-sequence';\nimport { ProtvistaSaver } from 'protvista-saver';\nimport { ProtVistaNavigation } from '@vendor/protvista-navigation';\nimport { ProtVistaInterproTrack } from 'protvista-interpro-track';\n\nimport { SqrutinyService } from '@services/sqrutiny.service';\nimport { Track } from 'app/optimizer/shared/track';\nimport { DisplayValuesComponent } from '../display-values/display-values.component';\nimport { HistoryService } from '../history.service';\nimport { FileService } from '@services/file.service';\nimport { LoaderService } from '@services/loader.service';\nimport { ExportModalComponent } from '../export-modal/export-modal.component';\nimport { FeatureService } from 'app/optimizer/shared/feature.service';\nimport { Feature } from 'app/optimizer/shared/feature';\nimport { SetCutoffComponent } from '../set-cutoff/set-cutoff.component';\n\nclass GraphsOption {\n  name?: string;\n  alias: string;\n  description?: string;\n  display: boolean;\n  data: any;\n  max?: number;\n  min?: number;\n  type: string;\n  cutoffs?: number[];\n  color: string;\n}\n\nclass Filter {\n  alias: string;\n  value: number;\n  op: string;\n  type: string;\n}\n\n@Component({\n  selector: 'sqy-result-viewer',\n  templateUrl: './result-viewer.component.html',\n  styleUrls: ['./result-viewer.component.scss']\n})\nexport class ResultViewerComponent implements AfterViewInit, OnDestroy {\n\n  @Input() set data(data: any) {\n    console.log('Test')\n    console.log(data)\n    this._data = [];\n    this.options = [];\n    if (!data.result || !data.construct || !data.result.length) {\n      return;\n    }\n    this._data = data;\n    this.loader.startLoading();\n    this._data.result.map((r: any) => {\n      this.options.push({\n        alias: r.alias,\n        display: true,\n        data: this.generateScores(),\n        type: 'raw',\n        color: this.getRandomColor()\n      });\n    });\n    this.getFeatures();\n  }\n\n  _data: any = null; // Original data\n  isSearching = false;\n  options: GraphsOption[] = [];\n  filters: Filter[] = [];\n  tplModal: NzModalRef;\n  operators = [\n    { desc: 'Greater or equal than', op: '<=' },\n    { desc: 'Greater than', op: '<' },\n    { desc: 'Equal to', op: '=' },\n    { desc: 'Lower or equal than', op: '>=' },\n    { desc: 'Lower than', op: '>' }\n  ];\n  operatorsFn = {\n    '<': (a: number, b: number) => a < b,\n    '<=': (a: number, b: number) => a <= b,\n    '=': (a: number, b: number) => a === b,\n    '>': (a: number, b: number) => a > b,\n    '>=': (a: number, b: number) => a >= b,\n  };\n\n  @ViewChild('dnaSeq') dnaSeq: ElementRef<ProtvistaSequence>;\n  @ViewChild('proteinSeq') proteinSeq: ElementRef<ProtvistaSequence>;\n  @ViewChild('tracksView') tracksElem: ElementRef<ProtVistaInterproTrack>;\n  @ViewChild('navigator') nav: ElementRef<ProtVistaNavigation>;\n  @ViewChild('saver') saver: ElementRef<ProtvistaSaver>;\n\n  constructor(\n    private sqSrvc: SqrutinyService,\n    private notify: NzMessageService,\n    private modal: NzModalService,\n    private fileSrvc: FileService,\n    private historySrvc: HistoryService,\n    private route: ActivatedRoute,\n    private loader: LoaderService,\n    private featureSrvc: FeatureService\n  ) { }\n\n  generateScores(){\n    let scores = []\n    for (let i = 0; i < this._data.construct.dna_seq.length; i++) {\n      scores.push ( {pos: i+1, score: Math.random() * 1})\n    }\n    return scores\n  }\n\n  ngAfterViewInit() {\n    // Init graphs\n    if (this._data && this.options) {\n\n      this.nav.nativeElement.length = this._data.construct.dna_seq.length;\n      document.querySelectorAll('.protvista').forEach((x: any) => x.setAttribute('length', this._data.construct.dna_seq.length));\n      this.dnaSeq.nativeElement.data = this._data.construct.dna_seq;\n      this.proteinSeq.nativeElement.data = this.toProteinSeqVw(this._data.construct.protein_seq);\n      this.tracksElem.nativeElement.data = this.getTrackView(this._data.construct.tracks);\n      document.querySelectorAll('.score-graph').forEach((x: any, i: number) => {\n        x.data = this.options[i].data;\n        x.color = this.options[i].color;\n      });\n      this.saver.nativeElement.preSave = () => {\n        this.loader.startLoading();\n        const base = document.querySelector('#results-graphs');\n        const title = document.createElement('h1');\n        title.setAttribute('id', 'tmp_title_element');\n        title.innerHTML = 'SQrutiny Result Snapshot';\n        base.insertBefore(title, base.firstChild);\n        base.querySelectorAll('.no-sv').forEach((element: HTMLElement) => element.style.display = 'none');\n        base.querySelectorAll('h3').forEach((element: HTMLElement) => element.style.fontSize = '12px');\n      };\n      this.saver.nativeElement.postSave = () => {\n        const base = document.querySelector('#results-graphs');\n        base.removeChild(document.getElementById('tmp_title_element'));\n        base.querySelectorAll('.no-sv').forEach((element: HTMLElement) => element.style.display = 'inherit');\n        base.querySelectorAll('h3').forEach((element: HTMLElement) => element.style.fontSize = '1.28571429rem');\n        this.loader.stopLoading();\n      };\n    }\n  }\n\n  ngOnDestroy() {\n    this.destroyModal();\n  }\n\n  private getTrackView(tracks: Track[]) {\n    return tracks.map((track: Track) => ({\n      accession: 'XXXXX',\n      start: track.start,\n      end: track.end,\n      color: track.color\n    }));\n  }\n\n  private toProteinSeqVw(val: string) {\n    return ` ${val.split('').join('  ')} `;\n  }\n\n  private getRandomColor() {\n    const letters = '0123456789ABCDEF';\n    let color = '#';\n    for (let i = 0; i < 6; i++) {\n      color += letters[Math.floor(Math.random() * 16)];\n    }\n    return color;\n  }\n\n  displayAll() {\n    this.options.map(x => x.display = true);\n  }\n\n  hideAll() {\n    this.options.map(x => x.display = false);\n  }\n\n  setHighlight(pos: string) {\n    if (pos) {\n      document.querySelectorAll('.protvista').forEach((x: any) => x.fixedHighlight = pos);\n    }\n  }\n\n  clearHighlight() {\n    document.querySelectorAll('.protvista').forEach((x: any) => x.fixedHighlight = undefined);\n  }\n\n  clearCutoffs(alias: string) {\n    /* tslint:disable:no-string-literal */\n    document.getElementById(alias)['cutoffs'] = undefined;\n    this.getByAlias(this.options, alias).cutoffs = null;\n    this.filters = this.filters.filter(f => f.alias !== alias);\n    document.getElementById('cutoff_' + alias).getElementsByTagName('p')[0].innerHTML = '';\n    document.getElementById('cutoff_' + alias).style.visibility = 'hidden';\n    /* tslint:enable:no-string-literal */\n  }\n\n  clearAllCutoffs() {\n    document.querySelectorAll('.score-graph').forEach((x: any) => x.cutoffs = undefined);\n    this.options.map(op => op.cutoffs = null);\n    this.filters = [];\n    document.querySelectorAll('.cutoff').forEach((c: HTMLElement) => c.style.visibility = 'hidden');\n  }\n\n  cutoffModal(alias: string) {\n    const op = this.getByAlias(this.options, alias);\n    if (op) {\n      this.tplModal = this.modal.create({\n        nzTitle: 'Set cutoff for ' + op.name,\n        nzContent: SetCutoffComponent,\n        nzWidth: 450,\n        nzComponentParams: {\n          option: op\n        },\n        nzOnOk: (cmp: SetCutoffComponent) => {\n          if (cmp.op !== null && cmp.value !== null && !Number.isNaN(cmp.value)) {\n            this.setThreshold({ alias, value: cmp.value, op: cmp.op, type: op.type });\n          }\n        }\n      });\n      this.tplModal.afterClose.subscribe(() => this.destroyModal());\n    }\n  }\n\n  private setThreshold(filter: Filter) {\n    if (filter.alias && filter.op && filter.value !== null) {\n      let values = [];\n      const op = this.getByAlias(this.options, filter.alias);\n      values = op.data.filter((d: any) => {\n        if (this.operatorsFn[filter.op](filter.value, d.score)) {\n          return {\n            pos: d.pos,\n            score: d.score\n          };\n        }\n      });\n      const operator = this.operators.find(o => o.op === filter.op);\n      if (values.length) {\n        op.cutoffs = values;\n        this.filters.push(filter);\n        /* tslint:disable:no-string-literal */\n        document.getElementById(filter.alias)['cutoffs'] = values.map((v: any) => v.pos);\n        /* tslint:enable:no-string-literal */\n        const element = document.getElementById('cutoff_' + filter.alias).getElementsByTagName('p')[0];\n        element.innerHTML = `<i class='filter icon'></i> ${operator.desc} ${filter.value}`;\n        element.style.visibility = 'visible';\n      } else {\n        this.clearCutoffs(filter.alias);\n        this.notify.info(`No results found for: ${operator.desc} ${filter.value} in ${op.name}`);\n      }\n    }\n  }\n\n  displayScore(alias: string) {\n    const data = this.getByAlias(this._data.result, alias);\n    this.valuesModal(data.scores, ['Start', 'End', 'Raw values', 'Normalized values'], this.getByAlias(this.options, alias).name + ' data');\n  }\n\n  displayCutoffs(alias: string) {\n    const op = this.getByAlias(this.options, alias);\n    this.valuesModal(op.cutoffs, ['Position', 'Score'], op.name + ' cutoff positions');\n  }\n\n  private valuesModal(values: any[], headers: string[], title?: string) {\n    this.tplModal = this.modal.create({\n      nzContent: DisplayValuesComponent,\n      nzWrapClassName: 'center-modal',\n      nzComponentParams: {\n        headers,\n        values,\n        title\n      },\n      nzFooter: null,\n    });\n    this.tplModal.afterClose.subscribe(() => this.destroyModal());\n  }\n\n  changeColors(alias?: string) {\n    if (alias) {\n      const op = this.getByAlias(this.options, alias);\n      op.color = this.getRandomColor();\n      /* tslint:disable:no-string-literal */\n      document.getElementById(alias)['color'] = op.color;\n      /* tslint:enable:no-string-literal */\n    } else {\n      this.options.forEach(o => o.color = this.getRandomColor());\n      document.querySelectorAll('.score-graph').forEach((x: any, i: number) => x.color = this.options[i].color);\n    }\n  }\n\n  switchScore(alias: string, type: string) {\n    const data = this.getByAlias(this._data.result, alias);\n    if (data) {\n      const op = this.getByAlias(this.options, alias);\n      this.clearCutoffs(op.alias);\n      op.data = data.scores.map((s: any) => ({\n        pos: s.start,\n        score: type === 'raw' ? s.raw_score : s.norm_score\n      }));\n      /* tslint:disable:no-string-literal */\n      document.getElementById(alias)['data'] = op.data;\n      /* tslint:enable:no-string-literal */\n      op.type = type;\n    }\n  }\n\n  searchMotif(motif: any) {\n    if (motif) {\n      this.isSearching = true;\n      this.sqSrvc.motifInSeq(this._data.construct.dna_seq, motif)\n        .pipe(finalize(() => this.isSearching = false))\n        .subscribe(\n          (data: any) => {\n            if (data.count > 0) {\n              let positions = '';\n              data.data.map((pos: number[]) => positions += `,${pos[0]}:${pos[1]}`);\n              if (positions.charAt(0) === ',') {\n                positions = positions.substring(1);\n              }\n              document.querySelectorAll('.protvista').forEach((x: any) => x.fixedHighlight = positions);\n            } else {\n              this.notify.error('No match was found');\n            }\n          },\n          err => this.notify.error(err)\n        );\n    }\n  }\n\n  private getFeatures() {\n    this.loader.startLoading();\n    this.featureSrvc\n      .getAll()\n      .subscribe(data => {\n        const features = data.map((e: any) => new Feature().deserialize(e));\n        this.options.map(o => {\n          const ft = features.find(f => f.alias === o.alias);\n          if (ft) {\n            o.name = ft.name;\n            o.description = ft.description;\n            o.min = ft.genome_min;\n            o.max = ft.genome_max;\n          }\n        });\n        this.loader.stopLoading();\n      }\n      );\n  }\n\n  // Export\n\n  exportCutoffToGb(alias: string) {\n    const filter = this.getByAlias(this.filters, alias);\n    if (filter) {\n      this.exportToGb([{ key: alias, filter }]);\n    }\n  }\n\n  exportModal() {\n    this.tplModal = this.modal.create({\n      nzTitle: 'Export wizard',\n      nzContent: ExportModalComponent,\n      nzComponentParams: {\n        items: this.options.map(o => ({ name: o.name, color: o.color, alias: o.alias }))\n      },\n      nzWidth: 700,\n      nzOkText: 'Export',\n      nzOnOk: (cmp: ExportModalComponent) => cmp.to === 'gb' ? this.exportToGb(cmp.list.map(l => ({ key: l })) || []) : this.exportToExcel(cmp.list || []),\n    });\n    this.tplModal.afterClose.subscribe(() => this.destroyModal());\n  }\n\n  destroyModal() {\n    if (this.tplModal) {\n      this.tplModal.destroy();\n    }\n  }\n\n  exportToGb(options: any) {\n    this.loader.startLoading();\n    if (options && !Array.isArray(options)) {\n      options = [options];\n    }\n    this.historySrvc.export(this.route.snapshot.data.history.id, { options: options || null })\n      .pipe(finalize(() => this.loader.stopLoading()))\n      .subscribe((d: any) => {\n        this.notify.success('Your download is about to start.');\n        this.fileSrvc.saveFileAs(d.data, d.mimetype, d.filename);\n      },\n        err => this.notify.error(err)\n      );\n  }\n\n  exportCutoffToExcel(alias?: string[]) {\n    let data = [];\n    if (alias) {\n      if (!Array.isArray(alias)) {\n        alias = [alias];\n      }\n      alias.map(a => {\n        const op = this.getByAlias(this.options, a);\n        if (op.cutoffs) {\n          data = [{ name: op.name, data: op.cutoffs }];\n        }\n      });\n    } else {\n      data = this.options.filter((o: GraphsOption) => !o.cutoffs);\n    }\n    if (data.length > 0) {\n      this.fileSrvc.exportAsExcelFile(data, data.length === 1 ? alias[0] : 'scores');\n      this.notify.success('Exported! Your download is about to start.');\n    } else {\n      this.notify.error('Unable to export.');\n    }\n  }\n\n  exportToExcel(alias?: string[]) {\n    let data = [];\n    if (alias) {\n      if (!Array.isArray(alias)) {\n        alias = [alias];\n      }\n      alias.map(a => {\n        const op = this.getByAlias(this._data.result, a);\n        data.push({ name: op.alias, data: op.scores });\n      });\n    } else {\n      data = this._data.result.map((v: any) => ({ name: v.alias, data: v.scores }));\n    }\n    if (data.length > 0) {\n      this.fileSrvc.exportAsExcelFile(data, data.length === 1 ? alias[0] : 'scores');\n      this.notify.success('Exported! Your download is about to start.');\n    } else {\n      this.notify.error('Unable to export.');\n    }\n  }\n\n  private getByAlias(data: any[], alias: string): any {\n    return data.find(o => o.alias === alias);\n  }\n}\n","<!-- Loading placeholder -->\n<sqy-history-loading *ngIf=\"!history\"></sqy-history-loading>\n\n<div class=\"ui main fluid container p-4 mt-6 basic segment\" [ngClass]=\"{'loading': isLoading}\" *ngIf=\"history\">\n\n  <div class=\"ui grid\">\n\n    <div class=\"row\" id=\"history\">\n\n      <div class=\"ui container\">\n\n        <div class=\"sixteen wide column\">\n\n          <div class=\"ui padded one column grid\">\n\n            <div class=\"column\">\n              <h1 class=\"ui header\">\n                {{history.name}}\n              </h1>\n            </div>\n\n            <div class=\"two column row\">\n\n              <div class=\"column\">\n                <span class=\"date\">\n                  <time [dateTime]=\"history.created_at\">{{history.created_at | date: 'DD MMMM, YYYY HH:mm'}}</time>\n                </span>\n                <div [hidden]=\"!history.job\" class=\"ant-badge ant-badge-status ant-badge-not-a-wrapper\">\n                  <span class=\"ant-badge-status-dot\" [ngClass]=\"{'ant-badge-status-error': history.hasFailed(), 'ant-badge-status-processing': history.isActive(), 'ant-badge-status-success': history.isDone()}\"></span>\n                  <span class=\"ant-badge-status-text\">{{history.job?.status | titlecase}}</span>\n                </div>\n              </div>\n\n              <div class=\"column txt-r\">\n\n                <a class=\"m-4\" *ngIf=\"history.isActive()\" (click)=\"getJob()\">\n                  <i class=\"sync icon\"></i>\n                  Refresh content\n                </a>\n\n                <a class=\"m-4 delete\" (click)=\"deleteHistory()\">\n                  <i class=\"trash icon\"></i>\n                  Delete history\n                </a>\n\n              </div>\n\n            </div>\n\n            <div class=\"eleven wide column\">\n              <div class=\"ui very relaxed horizontal selection large list\">\n                <div class=\"item\">\n                  <i class=\"barcode large icon\"></i>\n                  <div class=\"content\">\n                    <a class=\"header\" onclick=\"window.location.hash = 'construct'\">Construct</a>\n                    <p>Check Construct details</p>\n                  </div>\n                </div>\n                <div class=\"item\">\n                  <i class=\"chart bar outline large icon\"></i>\n                  <div class=\"content\">\n                    <a class=\"header\" onclick=\"window.location.hash = 'results'\">Plot area</a>\n                    <p>Go to results visualizator area</p>\n                  </div>\n                </div>\n              </div>\n            </div>\n\n            <div class=\"five wide column right aligned\">\n              <div class=\"ui action fluid input\">\n                <input type=\"text\" [value]=\"history.id\" name=\"history-id\">\n                <button type=\"button\" class=\"ui right labeled icon primary button\" name=\"copy\" [sqy-clipboard]=\"history.id\">\n                  Copy <i class=\"copy icon\"></i>\n                </button>\n              </div>\n            </div>\n\n          </div>\n\n        </div>\n\n      </div>\n\n    </div>\n\n    <div class=\"row\" id=\"construct\">\n\n      <div class=\"ui container\">\n\n        <div class=\"sixteen wide column\">\n\n          <div class=\"ui padded form construct-summary grid\">\n\n            <div class=\"one column row\">\n              <div class=\"column txt-c\">\n                <h2>Construct summary</h2>\n              </div>\n            </div>\n\n            <div class=\"one column row\">\n\n              <div class=\"column\">\n\n                <div class=\"field\" [hidden]=\"!history.construct.description\">\n                  <p>{{history.construct.description}}</p>\n                </div>\n\n                <div class=\"four inline fields\">\n\n                  <div class=\"field\">\n                    <label>Label:</label>\n                    {{history.construct.name}}\n                  </div>\n\n                  <div class=\"field\">\n                    <label>Number of tracks:</label>\n                    {{history.construct.n_tracks}}\n                  </div>\n\n                  <div class=\"field\">\n                    <label>Circular:</label>\n                    <i class=\"circle icon\" [ngClass]=\"{'check green': history.construct.circular, 'times red': !history.construct.circular}\"></i>\n                  </div>\n\n                  <div class=\"field\">\n                    <a routerLink=\"/optimize/sketcher\" [queryParams]=\"{construct: history.construct.id}\">See it on Sketcher <i class=\"external link icon\"></i> </a>\n                  </div>\n\n                  <div class=\"field\">\n                    <a [routerLink]=\"['/editor', history.id]\">See it on Vector Editor <i class=\"external link icon\"></i> </a>\n                  </div>\n\n                </div>\n\n              </div>\n\n            </div>\n\n            <div class=\"one column row\">\n\n              <div class=\"column\">\n                <h4 class=\"ui horizontal divider header\">\n                  <i class=\"bug icon\"></i>\n                  Organism\n                </h4>\n              </div>\n\n              <div class=\"column\">\n                <p>Open on <a [href]=\"history.construct.specie?.tax_link\" target=\"_blank\">NCBI Taxonomy browser</a> organism info</p>\n\n                <div class=\"two inline fields\">\n                  <div class=\"inline field\">\n                    <label>Name:</label>\n                    <a [href]=\"history.construct.specie?.tax_link\" target=\"_blank\">\n                      {{history.construct.specie?.name}}\n                    </a>\n                  </div>\n                  <div class=\"inline field\">\n                    <label>Taxonomy ID:</label>\n                    {{history.construct.specie?.tax_id}}\n                  </div>\n                </div>\n\n              </div>\n\n            </div>\n\n            <div class=\"one column row\">\n\n              <div class=\"column\">\n                <h4 class=\"ui horizontal divider header\">\n                  <i class=\"dna icon\"></i>\n                  Sequence\n                </h4>\n              </div>\n\n              <div class=\"column\">\n                <p> <i class=\"info icon\"></i> Click on sequence to display full content</p>\n\n                <table class=\"ui blue padded sequence definition table\">\n\n                  <tbody>\n                    <tr>\n                      <th>DNA</th>\n                      <td class=\"link\" (click)=\"textModal(history.construct.dna_seq)\">\n                        {{history.construct.dna_seq}}\n                      </td>\n                      <td>\n                        <strong>Total:</strong>\n                        {{history.construct.dna_seq.length}} bps\n                      </td>\n                    </tr>\n                    <tr>\n                      <th>Protein</th>\n                      <td class=\"link\" (click)=\"textModal(history.construct.protein_seq)\">\n                        {{history.construct.protein_seq}}\n                      </td>\n                      <td>\n                        <strong>Total:</strong>\n                        {{history.construct.protein_seq.length}}\n                      </td>\n                    </tr>\n                  </tbody>\n\n                </table>\n              </div>\n\n            </div>\n\n            <div class=\"one column row\">\n\n              <div class=\"column\">\n                <h4 class=\"ui horizontal divider header\">\n                  Tracks\n                </h4>\n              </div>\n\n              <div class=\"column\" style=\"min-height: 18px\">\n                <div class=\"ui grid\">\n                  <div class=\"four wide column\">\n                    <p> <i class=\"info icon\"></i> Hover a track to display information</p>\n                  </div>\n                  <div class=\"three wide column center aligned\" [hidden]=\"!trackHovered\">\n                    <strong>Start:</strong> {{trackHovered?.start}}\n                  </div>\n                  <div class=\"three wide column center aligned\" [hidden]=\"!trackHovered\">\n                    <strong>End:</strong> {{trackHovered?.end}}\n                  </div>\n                  <div class=\"three wide column center aligned\" [hidden]=\"!trackHovered\">\n                    <strong>Length:</strong> {{trackHovered?.sequence.length}} bps\n                  </div>\n                  <div class=\"right floated two wide column right aligned\">\n                    <p class=\"meta\">{{history.construct.n_tracks}} tracks</p>\n                  </div>\n                </div>\n              </div>\n\n              <div class=\"column\">\n\n                <div class=\"construct\">\n                  <div class=\"strand\">\n\n                    <div class=\"track\" (mouseover)=\"trackHovered = t\" (mouseout)=\"trackHovered = null\" (click)=\"showTrack(t)\" *ngFor=\"let t of history.construct.tracks; let i = index\">\n\n                      <div class=\"header\">\n                        <h4>{{t.label}}</h4>\n                      </div>\n                      <div class=\"image\" [ngStyle]=\"{background: 'url('+t.glyph_thumbnail+')', 'border-bottom': '1.5px solid '+t.color}\" data-inverted=\"\" [attr.data-tooltip]=\"t.name\" data-position=\"bottom center\"></div>\n                      <div class=\"index\">\n                        {{i + 1}}\n                      </div>\n                    </div>\n\n                  </div>\n                </div>\n\n              </div>\n\n            </div>\n\n          </div>\n\n        </div>\n\n      </div>\n\n    </div>\n\n    <div class=\"one column row\" id=\"results\">\n\n      <div class=\"column\">\n        <div class=\"ui protvista padded grid\">\n\n          <div class=\"one column row\">\n\n            <div class=\"ui basic segment column\" [ngClass]=\"{'disabled loading': isJobLoading}\">\n\n              <div class=\"ui placeholder segment\" [hidden]=\"!history.job\" *ngIf=\"history.hasFailed()\">\n                <div class=\"ui icon header\">\n                  <i class=\"times circle red icon\"></i>\n                  It was not possible to show you the results due to an internal problem. Please try again later or <a [routerLink]=\"'/contact'\">contact us</a>.\n                </div>\n              </div>\n\n              <div class=\"ui placeholder segment\" [hidden]=\"!history.job\" *ngIf=\"history.isActive()\">\n                <div class=\"ui icon header\">\n                  <i class=\"spinner loading icon\"></i>\n                  The results are processing please be patient...\n                </div>\n                <button class=\"ui primary right labeled icon button\" (click)=\"getJob()\" [disabled]=\"isJobLoading\" type=\"button\" name=\"refresh\">\n                  Refresh <i class=\"sync icon\"></i>\n                </button>\n              </div>\n\n              <sqy-result-viewer [data]=\"resultData\" *ngIf=\"history.isDone()\"></sqy-result-viewer>\n\n            </div>\n\n          </div>\n\n        </div>\n      </div>\n\n    </div>\n\n  </div>\n","import { Component, OnInit, OnDestroy } from '@angular/core';\nimport { ActivatedRoute, Router } from '@angular/router';\nimport { finalize } from 'rxjs/operators';\n\nimport { NzModalService } from 'ng-zorro-antd/modal';\nimport { NzMessageService } from 'ng-zorro-antd/message';\n\nimport { UserHistory } from '../shared/user-history';\nimport { HistoryService } from '../shared/history.service';\nimport { JobService } from '../shared/job.service';\nimport { Job } from '../shared/job';\nimport { Construct } from '@models/construct';\nimport { TextModalComponent } from '@components/text-modal/text-modal.component';\nimport { TitleService } from '@services/title.service';\nimport { Track } from 'app/optimizer/shared/track';\nimport { NavService } from '@services/nav.service';\nimport { TrackDisplayComponent } from '@components/track-display/track-display.component';\n\nconst MAX_ATTEMPTS = 50;\nconst RETRY_IN = 3000;\n\n@Component({\n  selector: 'sqy-history',\n  templateUrl: './history.component.html',\n  styleUrls: ['./history.component.scss']\n})\nexport class HistoryComponent implements OnInit, OnDestroy {\n\n  history: UserHistory = null;\n  isLoading = false;\n  isJobLoading = false;\n  resultData: { construct: Construct; result: any[] };\n  trackHovered: Track = null;\n  interval: any;\n  attempts = 0;\n  tplModal: any;\n\n  constructor(\n    private route: ActivatedRoute,\n    private router: Router,\n    private historySrvc: HistoryService,\n    private jobSrvc: JobService,\n    private modal: NzModalService,\n    private notify: NzMessageService,\n    private titleSrvc: TitleService,\n    private navSrvc: NavService\n  ) { }\n\n  ngOnInit() {\n    this.history = new UserHistory().deserialize(this.route.snapshot.data.history);\n    this.titleSrvc.setTitle(this.history.name);\n    this.getJob();\n  }\n\n  ngOnDestroy() {\n    if (this.interval) {\n      clearInterval(this.interval);\n    }\n    this.destroyModal();\n  }\n\n  getJob() {\n    this.isJobLoading = true;\n    this.jobSrvc.getById(this.history.job_id)\n      .pipe(finalize(() => {\n        this.isLoading = false;\n        this.isJobLoading = false;\n      }))\n      .subscribe(\n        (data: Job) => {\n          this.history.job = data;\n          if (this.history.isDone()) {\n            if (this.interval) {\n              clearInterval(this.interval);\n            }\n            this.resultData = { construct: this.history.construct, result: this.history.job.result };\n          } else if (this.history.isActive()) {\n            if (!this.interval) {\n              this.interval = setInterval(() => this.getJob(), RETRY_IN);\n              this.attempts = 0;\n            }\n            this.attempts++;\n            if (this.attempts >= MAX_ATTEMPTS) { clearInterval(this.interval); }\n          }\n        },\n        err => this.notify.error(err)\n      );\n  }\n\n  showTrack(track: Track) {\n    if (track) {\n      this.tplModal = this.modal.create({\n        nzContent: TrackDisplayComponent,\n        nzComponentParams: { track },\n        nzCancelText: null,\n        nzOnOk: () => {\n          if (this.tplModal) {\n            this.tplModal.destroy();\n          }\n        }\n      });\n      this.tplModal.afterClose.subscribe(() => this.destroyModal());\n    }\n  }\n\n  destroyModal() {\n    if (this.tplModal) {\n      this.tplModal.destroy();\n    }\n  }\n\n  deleteHistory() {\n    if (confirm('Are you sure?')) {\n      this.isLoading = true;\n      this.historySrvc.delete(this.history.id)\n        .pipe(finalize(() => this.isLoading = false))\n        .subscribe(() => {\n          this.navSrvc.updateBadge();\n          this.notify.success('History deleted!');\n          this.router.navigate(['/workspace']);\n        },\n          err => this.notify.error(err || 'Unable to delete history')\n        );\n    }\n  }\n\n  textModal(str: string) {\n    this.tplModal = this.modal.create({\n      nzContent: TextModalComponent,\n      nzWrapClassName: 'center-modal',\n      nzComponentParams: {\n        txt: str\n      },\n      nzFooter: null\n    });\n    this.tplModal.afterClose.subscribe(() => this.destroyModal());\n  }\n\n}\n","import { NgModule } from '@angular/core';\nimport { Routes, RouterModule } from '@angular/router';\n\nimport { WorkspaceComponent } from './workspace.component';\nimport { HistoryComponent } from './history/history.component';\nimport { HistoryResolver } from './shared/history.resolver';\nimport { routes as rts } from '@config/routes';\n\nconst routes: Routes = [\n  { path: '', component: WorkspaceComponent },\n  { path: rts.workspace.detail, component: HistoryComponent, resolve: { history: HistoryResolver } }\n];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule],\n  providers: [HistoryResolver]\n})\nexport class WorkspaceRoutingModule { }\n","import { NgModule, CUSTOM_ELEMENTS_SCHEMA } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { ReactiveFormsModule } from '@angular/forms';\n\nimport { NzModalModule } from 'ng-zorro-antd/modal';\nimport { NzDropDownModule } from 'ng-zorro-antd/dropdown';\nimport { NzSelectModule } from 'ng-zorro-antd/select';\n\nimport { WorkspaceRoutingModule } from './workspace-routing.module';\nimport { WorkspaceComponent } from './workspace.component';\nimport { HistoryComponent } from './history/history.component';\nimport { HistoryLoadingComponent } from './shared/history-loading/history-loading.component';\nimport { SharedModule } from '../shared/shared.module';\nimport { ResultViewerComponent } from './shared/result-viewer/result-viewer.component';\nimport { DisplayValuesComponent } from './shared/display-values/display-values.component';\nimport { SetHighlightComponent } from './shared/set-highlight/set-highlight.component';\nimport { ExportModalComponent } from './shared/export-modal/export-modal.component';\nimport { SetCutoffComponent } from './shared/set-cutoff/set-cutoff.component';\n\n@NgModule({\n  declarations: [\n    WorkspaceComponent,\n    HistoryComponent,\n    HistoryLoadingComponent,\n    ResultViewerComponent,\n    DisplayValuesComponent,\n    SetHighlightComponent,\n    ExportModalComponent,\n    SetCutoffComponent\n  ],\n  imports: [\n    CommonModule,\n    WorkspaceRoutingModule,\n    SharedModule,\n    NzModalModule,\n    NzDropDownModule,\n    ReactiveFormsModule,\n    NzSelectModule\n  ],\n  schemas: [\n    CUSTOM_ELEMENTS_SCHEMA\n  ]\n})\nexport class WorkspaceModule { }\n"]}