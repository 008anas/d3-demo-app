<div class="ui vertically divided grid">

  <div class="equal width center aligned middle aligned row" style="padding: 0em">

    <div class="column">
      <button class="ui primary circular icon button" data-inverted="" data-tooltip="Reset charts" data-position="top center" (click)="clearHighlight()">
        <i class="sync icon"></i>
      </button>
    </div>

    <div class="column">
      <button class="ui primary circular icon button" data-inverted="" data-tooltip="Clear highlight" data-position="top center" (click)="clearHighlight()">
        <i class="eraser icon"></i>
      </button>
    </div>

    <div class="column">
      <div class="ui icon fluid input" [ngClass]="{'loading disabled': isSearching}">
        <i class="search icon"></i>
        <input type="text" placeholder="Search for motif" (keyup.enter)="searchMotif($event.target.value)">
      </div>
    </div>

    <div class="column">
      <nz-select class="w-1-1" nzPlaceHolder="Restriction enzyme" (ngModelChange)="searchMotif($event)" [(ngModel)]="enzime" ngDefaultControl nzAllowClear>
        <nz-option *ngFor="let e of enzimes" [nzLabel]="e" [nzValue]="e"></nz-option>
      </nz-select>
    </div>

    <div class="column">
      <button class="ui primary right labeled icon button simple dropdown" type="button">
        Export to
        <i class="dropdown icon"></i>
        <div class="menu">
          <div class="item">
            <i class="file icon"></i>
            PNG/JPG
          </div>
          <div class="item">
            <i class="dna icon"></i>
            GenBank
          </div>
        </div>
      </button>
    </div>

  </div>

  <div class="equal width center aligned middle aligned row" style="padding: 0em">
    <div class="column">
      <strong>DNA sequence length:</strong> {{_data.construct?.dna_seq.length}}
    </div>
    <div class="column">
      <strong>Protein sequence length:</strong> {{_data.construct?.protein_seq.length}}
    </div>
    <div class="column">
      <strong>Number of tracks:</strong> {{_data.construct?.n_tracks}}
    </div>
  </div>

  <div class="one column row">

    <div class="column mt-0">

      <protvista-manager attributes="length displaystart displayend highlight">
        <div class="ui very padded grid graphs">

          <div class="one column row">
            <div class="column">
              <protvista-navigation length="100000" class="protvista"></protvista-navigation>
            </div>

            <div class="column">
              <protvista-sequence class="protvista" highlight-event="onmouseover" #dnaSeq></protvista-sequence>
            </div>

            <div class="column">
              <protvista-sequence class="protvista" highlight-event="onmouseover" #proteinSeq></protvista-sequence>
            </div>

            <div class="column">
              <protvista-interpro-track class="protvista" shape="roundRectangle" highlight-event="onmouseover" #tracksView></protvista-interpro-track>
            </div>

            <div class="column">

              <div class="ui top attached menu">

                <div class="item">
                  <button class="ui primary labeled icon right button" type="button" (click)="isVisible = true">
                    <i class="filter icon"></i>
                    Threshold
                  </button>
                </div>

                <div class="item">
                  <button type="button" class="ui primary button" [disabled]="!filters">
                    Export threshold
                  </button>
                </div>

                <div class="right menu">
                  <div class="item">
                    <button class="ui primary labeled icon right simple dropdown button" type="button">
                      <i class="eye icon"></i>
                      <span class="text">Visibility</span>
                      <div class="menu">
                        <div class="header">
                          Click to Show or Hide
                        </div>
                        <a class="ant-badge ant-badge-status ant-badge-not-a-wrapper item" *ngFor="let o of options" [ngClass]="{'non-active': !o.display}" (click)="o.display = !o.display">
                          <span class="ant-badge-status-dot" [style.background-color]="o.color"></span>
                          <span class="ant-badge-status-text">{{o.name | titlecase}}</span>
                        </a>
                        <div class="ui divider"></div>
                        <a class="item" (click)="displayAll()">
                          <i class="eye icon"></i>
                          Display all
                        </a>
                        <a class="item" (click)="hideAll()">
                          <i class="eye slash icon"></i>
                          Hide all
                        </a>
                      </div>
                    </button>
                  </div>
                </div>

              </div>

            </div>

            <div class="column pt-5" [hidden]="!op.display" *ngFor="let op of options; let i = index">

              <div class="ui padded grid">

                <div class="row">
                  <div class="column">
                    <h3 class="ui horizontal divider header">{{op.name | titlecase}}</h3>
                  </div>
                </div>

                <div class="row">

                  <!-- <div class="column" style="width: fit-content;">
                    <nz-select class="action-m" nzAllowClear [(ngModel)]="op.values" (ngModelChange)="changeValues(i)" nzPlaceHolder="Type" nzSize="small" style="width: 160px">
                      <nz-option nzValue="norm" nzLabel="Normalized value"></nz-option>
                      <nz-option nzValue="raw" nzLabel="Raw value"></nz-option>
                    </nz-select>
                  </div>

                  <div class="column p-2" style="width: fit-content;">
                    <a (click)="valuesModal(i)">See {{op.values === 'raw' ? 'raw' : 'normalized'}} values</a>
                  </div>

                  <div class="column p-2" style="width: fit-content;">
                    <a (click)="clearThreshold(i)">Clear threshold</a>
                  </div>

                  <div class="column" style="width: fit-content;">
                    <nz-select class="action-m" nzSize="small" [(ngModel)]="op.operator" nzPlaceHolder="Operator">
                      <nz-option *ngFor="let o of operators" [nzLabel]="o.desc" [nzValue]="o.op"></nz-option>
                    </nz-select>
                  </div>

                  <div class="column" style="width: fit-content;">
                    <input type="number" placeholder="Score" (keyup.enter)="setThreshold($event.target.value, i)" style="width: 100px" />
                  </div> -->

                  <div class="column right aligned">
                    <a [ngClass]="{'disabled': i < 1 || options.length < 2}" (click)="move(i, -1)">
                      Move up <i class="up arrow icon"></i>
                    </a>
                    <a [ngClass]="{'disabled': i === options.length - 1 || options.length < 2}" (click)="move(i, 1)">
                      Move down <i class="down arrow icon"></i>
                    </a>
                    <a (click)="op.display = false">
                      Hide <i class="eye slash icon"></i>
                    </a>
                  </div>

                </div>

              </div>

              <sqrutiny-matrix class="protvista matrix-graph" id="matrix-graph{{i}}" height="60"></sqrutiny-matrix>

            </div>
          </div>

        </div>
      </protvista-manager>

    </div>

  </div>

</div>

<nz-modal [(nzVisible)]="isVisible" nzTitle="Threshold" (nzOnCancel)="isVisible = false" (nzOnOk)="applyFilters()">

  <div class="ui grid">

    <div class="row">
      <div class="column">
        <h1 class="ui header">
          <i class="filter icon"></i> Set threshold for graphs
        </h1>
      </div>
    </div>

    <div class="row">
      <div class="column">

      </div>
    </div>

    <div class="row">
      <div class="column">
        <button type="button" class="ui fluid button" [disabled]="filters?.length >= options.length">
          <i class="plus icon"></i>
          Add filter
        </button>
      </div>
    </div>

  </div>

</nz-modal>
